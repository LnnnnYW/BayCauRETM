% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/data_pre.R
\name{preprocess_data}
\alias{preprocess_data}
\title{Preprocess Long-Format Data for Causal Recurrent-Event Modeling}
\usage{
preprocess_data(df, K, x_cols = NULL)
}
\arguments{
\item{df}{A \emph{long-format} \code{data.frame} that \strong{already contains} the analysis
columns \code{pat_id}, \code{k_idx}, \code{Y_obs}, \code{T_obs}, \code{A}, plus any additional
covariates.}

\item{K}{Integer. Total number of discrete intervals per subject.}

\item{x_cols}{Character vector of additional covariate column names, or \code{NULL}.}
}
\value{
A list with components:
\itemize{
\item \strong{processed_df} - The input data with added lagged variables \code{Y_prev},
\code{T_prev}, and filled-in intervals.
\item \strong{n_pat} - Integer, number of unique subjects.
}
}
\description{
Prepares a long-format dataset (already using standardized column names) for
discrete-time Bayesian causal modeling of recurrent and terminal events.
}
\details{
The data \strong{must already follow} the naming convention
\verb{*_obs} for observed quantities and \verb{*_prev} for their lagged counterparts.
The function therefore \emph{does not} rename columns.  Its only tasks are to
fill in missing intervals, create lagged variables, run basic validity
checks, and return the results.
}
\examples{
df_long <- data.frame(
  pat_id = rep(1:5, each = 3),
  k_idx  = rep(1:3, times = 5),
  Y_obs  = sample(0:2, 15, TRUE),
  T_obs  = rbinom(15, 1, 0.1),
  A      = rbinom(15, 1, 0.5),
  age    = rnorm(15, 60, 10)
)
\dontrun{
out <- preprocess_data(df_long, K = 3, x_cols = "age")
str(out)
}

}
